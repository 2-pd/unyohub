--------------------------------------------------------------------------------

  ユーザー投稿型鉄道運用データベース「鉄道運用Hub」設計案    ページ(10)

--------------------------------------------------------------------------------

_/_/_/_/ 時刻表データ入力規則 _/_/_/_/

※「時刻表入力サンプル」と合わせて確認してください。なお、サンプルには2024年1月改正の南海高野線・泉北線の平日下り時刻表から一部の列車を抜粋して使用しています。

(1) ファイル形式について
ファイル形式は、データ変換に適した「CSV」を使用します。
CSVはLibreOffice CalcやExcelで編集できますが、保存時に装飾情報が削除されてしまうことに留意してください。(列の幅やセルの色、フォントサイズなどはファイルに保存されません。)

なお、時刻表では、英数字は全て半角で入力する必要があります。


(2) ファイル名について
時刻表ファイルはダイヤパターン(「平日ダイヤ」、「土休日ダイヤ」など)ごとに上りと下りを分けて作ります。
それぞれのファイル名は「timetable_」(最後に半角アンダーバーが必要です)のあとにダイヤ識別名、半角ピリオド、方面(「inbound」または「outbound」)を順に続けて、「timetable_ダイヤ識別名.方面.csv」の形式としてください。
例えば、ダイヤ識別名が「weekday」の場合、上り時刻表のファイル名は「timetable_weekday.inbound.csv」となります。


(3) 駅名記載列について
時刻表CSVファイルでは、A列を駅名記載列とします。
駅名記載列では、4行目(全列車の行き先を記載しない場合は3行目)から駅名を列車の停車順に列挙してください。
信号場の発着時刻を時刻表に記載する場合は、信号場名も駅名と同様にこの列へ記載しておく必要があります。

待避駅や単線区間の交換駅、運転停車が行われる信号場では、各列車に着時刻と発時刻の両方を記載することでエンドユーザーの利便性を向上することができます。
1つの駅に対して着時刻と発時刻の両方を記載する場合は、駅名記載列の駅名の末尾に「[着]」と「[発]」(いずれも角括弧は半角)をそれぞれ付加した行を個別に設けてください。

なお、時刻表に複数の路線が含まれる場合も、全ての路線の駅名をこの行に含める必要があります。
ここで、路線Xと路線Yの上り列車がともに路線Zに乗り入れている時刻表を例に考えると、駅名の記載順は、上りではXの駅→Yの駅→Zの駅、または、Yの駅→Xの駅→Zの駅の順、下りではZの駅→Yの駅→Xの駅、または、Zの駅→Xの駅→Yの駅の順となります。

ある路線の上り列車が別の路線に下り列車として乗り入れている(あるいはその逆)のようなケースでは、どちらかの路線の上り列車を下り、下り列車を上りの時刻表に記載することになるため、その路線の駅名は上りの時刻表に下りの順、下りの時刻表に上りの順で記載されることになります。


(4) 路線識別名記載列について
B列は路線識別名記載列となります。

路線識別名記載列の1行目では、路線識別名を列車が走行する順に半角スペースで区切って列挙します。
前述の路線X、Y、Zを例に上げると、記載内容は、上りでは「X Y Z」または「Y X Z」、下りでは「Z Y X」または「Z X Y」となります。
なお、上り列車が別の路線に下り列車として乗り入れている(またはその逆の)ケースでは、ここで列挙する路線識別名に、上り時刻表中に含まれている下り向きの路線では「.outbound」、下り時刻表中に含まれている上り向きの路線では「.inbound」をそれぞれ付加して、「路線識別名.outbound」や「路線識別名.inbound」のように記載する必要があります。

4行目(全列車で行き先を記載しない場合は3行目)からは、同じ行の駅名記載列(A列)に記載した駅名の駅が所属している路線の路線識別名を入力します。
複数の路線に所属している駅では、路線識別名をスペースで区切って入力してください。同じ駅を路線ごとに別々の行に分けて記載している場合や、到着時刻がない路線(当該駅から分岐)や発車時刻がない路線(当該駅で合流)が存在する場合には、それぞれの行に記載する路線識別名は対応する路線のものだけとなります。


(5) 各列車の列について
C列以降には、各列車の列車番号、種別、行き先、各駅発時刻(終着駅のみ着時刻)を記載します。
このとき、増解結により途中で組成が変わる列車については、その前後で列車番号が変化しない場合であっても、増解結する駅を境として別々の列に記載しなければなりません。
また、列車の記載順序については、原則として順不同で問題ありません。

各列車の列の1行目には、列車番号を入力します。
列車番号のない列車を時刻表に含めることはできないため、列車番号の不明な列車にはそれぞれ異なる仮列車番号を付与するなどして対応してください。
列車番号の前に「◆」(黒ひし形)を付加すると、その列車は予定臨時列車として扱われ、運用表に記載されている場合にのみ各駅の時刻表で表示されるようになります。

2行目には、列車の種別を入力します。
種別の代わりに特急列車の愛称などを入力することも可能です。

3行目には、列車の行き先を入力します。
行き先の表示と終着駅が同一である場合は入力せずに空欄とすることができるほか、全列車の行き先入力が不要な場合には、この行そのものを省略して下記の発時刻を3行目から入力することも可能です。

4行目(全列車で行き先を記載しない場合は3行目)以降は、各駅の発時刻(終着駅のみ着時刻)を入力します。
時刻は、時と分の間に半角コロンを挟んだ「12:34」のような形式か、コロンを省略した「1234」のような形式のいずれかで入力してください。
通過時刻や運転停車の時刻は分岐駅の場合(後述)を除いて空欄で問題ありませんが、「|」(半角バーティカルバー)を先頭に付けて、「|12:34」のように入力することもできます。

分岐駅を通過して別の路線に乗り入れる列車の場合は、必ず分岐駅の通過時刻を時刻表に含める必要があります。
分岐駅の通過時刻が正確に定まっていない場合でも、分岐駅を通過する推定時刻を入力してください。
また、必須の設定ではありませんが、先行列車を追い越す駅や単線区間で対向列車と行き違いをする駅には通過時刻を設定したほうが走行位置の誤差を抑えることができます。

最後に、ある列車が途中から異なる列車番号の列車として運転される場合や、途中駅で増解結されるために複数列に分けて記載している場合には、列車番号または組成が変わる前の列車の列の最終行(駅名が記載されていない行)に、列車番号または組成が変わったあとの列車の列車番号を入力することで、アプリ上で2つの列車を連続する列車として表示することができます。この場合、前の列車の行き先行が空欄なら後の列車の行き先(これも空欄なら後の列車の終着駅)が自動的に前の列車の行き先としてアプリ上で表示されます。
なお、複数の列車を連続する列車として表示させる場合には、前の列車と後の列車は時刻表上での記載順序が入れ替わってはなりません。(前の列車が時刻表上で後の列車より左側の列に記載されている必要があります。)
多層建て列車が2列車に分割される場合は、列車番号を半角スペースで区切って入力することにより対応可能です。
上り時刻表に記載されている列車が途中から下り時刻表に記載の列車として連続で運転される場合(あるいはその逆)は、先の列車の時刻を記載した列の最終行へ列車番号のあとに「@路線識別名.方面」の形式であとの列車が最初に走行する路線と方面(「inbound」または「outbound」)を付加する必要があります。このとき、先の列車とあとの列車で列車番号が同一の場合は列車番号を省略し、アットマーク以降のみの記載とすることも可能です。
